<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Tracker v1.10.0</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; padding: 20px; }
        #root { max-width: 1400px; margin: 0 auto; }
        .app-container { background: #0f1419; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 700; }
        .header .version { font-size: 0.9em; opacity: 0.9; }
        .tab-navigation { display: flex; background: #1a1f2e; border-bottom: 2px solid #2d3748; overflow-x: auto; }
        .tab-button { flex: 1; min-width: 150px; padding: 18px 24px; background: transparent; border: none; cursor: pointer; font-size: 1em; font-weight: 600; color: #a0aec0; transition: all 0.3s ease; border-bottom: 3px solid transparent; }
        .tab-button:hover { background: #2d3748; color: #e2e8f0; }
        .tab-button.active { color: #667eea; border-bottom-color: #667eea; background: #0f1419; }
        .tab-content { padding: 30px; background: #0f1419; }
        .yearly-overview { background: #1a1f2e; padding: 40px; border-radius: 15px; margin-bottom: 30px; text-align: center; }
        .yearly-overview h2 { color: #a0aec0; font-size: 1.2em; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; }
        .yearly-overview .amount { font-size: 3.5em; font-weight: 700; margin-bottom: 10px; }
        .yearly-overview.income .amount { color: #28a745; }
        .yearly-overview.expense .amount { color: #dc3545; }
        .yearly-overview.net .amount.positive { color: #28a745; }
        .yearly-overview.net .amount.negative { color: #dc3545; }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .summary-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .summary-card h3 { font-size: 0.9em; opacity: 0.9; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .summary-card .amount { font-size: 2em; font-weight: 700; }
        .summary-card .subtitle { font-size: 0.85em; opacity: 0.85; margin-top: 8px; }
        .section { background: #1a1f2e; padding: 25px; border-radius: 15px; margin-bottom: 20px; }
        .section h2 { color: #667eea; margin-bottom: 20px; font-size: 1.5em; }
        .category-filters { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
        .category-filter-btn { background: #2d3748; color: #a0aec0; border: 2px solid transparent; padding: 10px 20px; border-radius: 25px; font-size: 0.9em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .category-filter-btn:hover { background: #4a5568; color: #e2e8f0; }
        .category-filter-btn.active { background: #667eea; color: white; border-color: #667eea; }
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        @media (max-width: 968px) { .dashboard-grid { grid-template-columns: 1fr; } }
        .debt-overview-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .debt-mini-card { background: #1a1f2e; padding: 18px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); border-left: 4px solid #ffc107; }
        .debt-mini-card h4 { color: #e2e8f0; margin-bottom: 8px; font-size: 1em; }
        .debt-mini-card .debt-amount { font-size: 1.4em; font-weight: 700; color: #667eea; margin-bottom: 8px; }
        .debt-mini-card .debt-info { font-size: 0.85em; color: #a0aec0; margin-bottom: 4px; }
        .form-group { margin-bottom: 20px; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; color: #a0aec0; font-weight: 600; font-size: 0.9em; }
        input, select { width: 100%; padding: 12px; border: 2px solid #2d3748; border-radius: 8px; font-size: 1em; transition: border-color 0.3s; background: #0f1419; color: #e2e8f0; }
        input:focus, select:focus { outline: none; border-color: #667eea; }
        button { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 30px; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
        button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4); }
        button:active { transform: translateY(0); }
        button.secondary { background: #6c757d; margin-left: 10px; }
        button.danger { background: #dc3545; }
        button.success { background: #28a745; }
        .transaction-list, .payment-list, .debt-list { margin-top: 20px; }
        .transaction-item, .payment-item, .debt-item { background: #1a1f2e; padding: 20px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); display: flex; justify-content: space-between; align-items: center; }
        .transaction-item.income { border-left: 4px solid #28a745; }
        .transaction-item.expense { border-left: 4px solid #dc3545; }
        .payment-item.paid { opacity: 0.6; border-left: 4px solid #28a745; }
        .payment-item.unpaid { border-left: 4px solid #ffc107; }
        .item-details h4 { color: #e2e8f0; margin-bottom: 5px; }
        .item-details p { color: #a0aec0; font-size: 0.9em; }
        .item-amount { font-size: 1.3em; font-weight: 700; }
        .item-amount.positive { color: #28a745; }
        .item-amount.negative { color: #dc3545; }
        .controls { display: flex; gap: 10px; margin-top: 20px; }
        .collapsible-section { margin-bottom: 15px; }
        .collapsible-header { background: #667eea; color: white; padding: 15px 20px; border-radius: 10px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background 0.3s; }
        .collapsible-header:hover { background: #5568d3; }
        .collapsible-header h3 { margin: 0; font-size: 1.2em; }
        .collapsible-content { padding: 20px; background: #0f1419; border-radius: 0 0 10px 10px; margin-top: 2px; }
        .debt-item { border-left: 4px solid #ffc107; }
        .progress-bar { width: 100%; height: 8px; background: #2d3748; border-radius: 4px; overflow: hidden; margin-top: 10px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #28a745, #20c997); transition: width 0.3s ease; }
        .debt-details { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 15px; font-size: 0.9em; }
        .debt-detail-item { padding: 10px; background: #1a1f2e; border-radius: 5px; }
        .debt-detail-item label { font-size: 0.8em; color: #a0aec0; margin-bottom: 5px; }
        .debt-detail-item .value { font-weight: 700; color: #e2e8f0; }
        .paid-badge { background: #28a745; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: 600; margin-left: 10px; }
        .auto-badge { background: #17a2b8; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: 600; margin-left: 10px; }
        .manual-badge { background: #6c757d; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.8em; font-weight: 600; margin-left: 10px; }
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .modal { background: #1a1f2e; border-radius: 15px; padding: 30px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .modal h2 { color: #667eea; margin-bottom: 20px; }
        .budget-overview { background: linear-gradient(135deg, #28a74522 0%, #20c99722 100%); border: 2px solid #28a745; padding: 30px; border-radius: 15px; margin-bottom: 30px; }
        .budget-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #2d3748; }
        .budget-row:last-child { border-bottom: none; }
        .budget-row.total { border-top: 3px solid #667eea; padding-top: 20px; margin-top: 15px; font-size: 1.3em; font-weight: 700; }
        .budget-label { color: #a0aec0; font-size: 1.1em; }
        .budget-label.total { color: #e2e8f0; }
        .budget-value { font-size: 1.3em; font-weight: 700; color: #e2e8f0; }
        .budget-value.positive { color: #28a745; }
        .budget-value.negative { color: #dc3545; }
        .budget-value.warning { color: #ffc107; }
        .income-input-group { display: flex; gap: 15px; align-items: flex-end; margin-bottom: 30px; }
        .income-input-group .form-group { flex: 1; margin-bottom: 0; }
        @media (max-width: 768px) { .tab-navigation { flex-wrap: wrap; } .tab-button { flex: 1 1 50%; } .summary-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const CATEGORIES = ['Income', 'Food', 'Gas', 'Car Payment', 'House Cleaning', 'Mortgage', 'Utilities', 'Entertainment', 'Healthcare', 'Shopping', 'Other'];

        function FinanceTracker() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [transactions, setTransactions] = useState([]);
            const [recurringPayments, setRecurringPayments] = useState([]);
            const [debts, setDebts] = useState([]);
            const [expectedMonthlyIncome, setExpectedMonthlyIncome] = useState(5000);

            const formatCurrency = (amount) => {
                return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(amount);
            };

            const getFinancialMonth = (date) => {
                const d = new Date(date);
                const day = d.getDate();
                let month = d.getMonth();
                let year = d.getFullYear();
                
                if (day < 28) {
                    month -= 1;
                    if (month < 0) {
                        month = 11;
                        year -= 1;
                    }
                }
                
                return `${year}-${String(month + 1).padStart(2, '0')}`;
            };

            const getFinancialMonthRange = (yearMonth) => {
                const [year, month] = yearMonth.split('-').map(Number);
                const startDate = new Date(year, month - 1, 28);
                const endMonth = month === 12 ? 0 : month;
                const endYear = month === 12 ? year + 1 : year;
                const endDate = new Date(endYear, endMonth, 27, 23, 59, 59);
                return { start: startDate, end: endDate };
            };

            const addTransaction = (transaction) => {
                const newTransaction = {
                    ...transaction,
                    id: Date.now(),
                    isRecurring: transaction.isRecurring || false
                };
                setTransactions([...transactions, newTransaction]);
            };

            const updateTransaction = (id, updatedTransaction) => {
                setTransactions(transactions.map(t => t.id === id ? { ...updatedTransaction, id } : t));
            };

            const deleteTransaction = (id) => {
                setTransactions(transactions.filter(t => t.id !== id));
            };

            const addRecurringPayment = (payment) => {
                setRecurringPayments([...recurringPayments, { ...payment, id: Date.now() }]);
            };

            const updateRecurringPayment = (id, updatedPayment) => {
                setRecurringPayments(recurringPayments.map(p => p.id === id ? { ...updatedPayment, id } : p));
            };

            const deleteRecurringPayment = (id) => {
                setRecurringPayments(recurringPayments.filter(p => p.id !== id));
            };

            const addDebt = (debt) => {
                setDebts([...debts, { ...debt, id: Date.now(), transactions: [] }]);
            };

            const updateDebt = (id, updatedDebt) => {
                setDebts(debts.map(d => d.id === id ? { ...updatedDebt, id, transactions: d.transactions } : d));
            };

            const deleteDebt = (id) => {
                setDebts(debts.filter(d => d.id !== id));
            };

            const processRecurringPayments = () => {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                let updatedPayments = [...recurringPayments];
                let newTransactions = [...transactions];
                let updatedDebts = [...debts];
                let hasChanges = false;

                recurringPayments.forEach(payment => {
                    if (!payment.autoPay) return;

                    const dueDate = new Date(payment.dueDate);
                    dueDate.setHours(0, 0, 0, 0);

                    if (dueDate <= today && !payment.paid) {
                        const isDuplicate = transactions.some(t => 
                            t.description === payment.description && 
                            t.amount === payment.amount && 
                            Math.abs(new Date(t.date) - dueDate) < 86400000
                        );

                        if (!isDuplicate) {
                            const newTransaction = {
                                id: Date.now() + Math.random(),
                                date: payment.dueDate,
                                description: payment.description,
                                amount: payment.amount,
                                category: payment.category,
                                isRecurring: true
                            };
                            newTransactions.push(newTransaction);

                            if (payment.linkedDebtId) {
                                const debtIndex = updatedDebts.findIndex(d => d.id === payment.linkedDebtId);
                                if (debtIndex !== -1) {
                                    const debt = updatedDebts[debtIndex];
                                    const monthlyInterest = (debt.balance * (debt.apr / 100)) / 12;
                                    const principalPayment = payment.amount - monthlyInterest;
                                    const newBalance = debt.balance - principalPayment;

                                    const debtTransaction = {
                                        date: payment.dueDate,
                                        payment: payment.amount,
                                        interest: monthlyInterest,
                                        principal: principalPayment,
                                        balanceBefore: debt.balance,
                                        balanceAfter: newBalance
                                    };

                                    updatedDebts[debtIndex] = {
                                        ...debt,
                                        balance: newBalance,
                                        transactions: [...(debt.transactions || []), debtTransaction]
                                    };
                                }
                            }

                            updatedPayments = updatedPayments.map(p =>
                                p.id === payment.id ? { ...p, paid: true } : p
                            );

                            hasChanges = true;
                        }
                    }
                });

                if (hasChanges) {
                    setTransactions(newTransactions);
                    setRecurringPayments(updatedPayments);
                    setDebts(updatedDebts);
                }
            };

            useEffect(() => {
                processRecurringPayments();
            }, [recurringPayments]);

            const exportData = () => {
                const data = {
                    transactions,
                    recurringPayments,
                    debts,
                    settings: {
                        expectedMonthlyIncome
                    },
                    version: '1.10.0',
                    exportDate: new Date().toISOString()
                };
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `finance-tracker-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            };

            const importData = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            setTransactions(data.transactions || []);
                            setRecurringPayments(data.recurringPayments || []);
                            setDebts(data.debts || []);
                            if (data.settings && data.settings.expectedMonthlyIncome) {
                                setExpectedMonthlyIncome(data.settings.expectedMonthlyIncome);
                            }
                            alert('Data imported successfully!');
                        } catch (error) {
                            alert('Error importing data. Please check the file format.');
                        }
                    };
                    reader.readAsText(file);
                }
            };

            const clearAllData = () => {
                if (window.confirm('Are you sure you want to clear all data? This cannot be undone.')) {
                    setTransactions([]);
                    setRecurringPayments([]);
                    setDebts([]);
                    setExpectedMonthlyIncome(5000);
                }
            };

            return (
                <div className="app-container">
                    <div className="header">
                        <h1>üí∞ Finance Tracker</h1>
                        <div className="version">v1.10.0 - Money Available Tracking</div>
                    </div>
                    
                    <div className="tab-navigation">
                        <button className={`tab-button ${activeTab === 'dashboard' ? 'active' : ''}`} onClick={() => setActiveTab('dashboard')}>üìä Dashboard</button>
                        <button className={`tab-button ${activeTab === 'budget' ? 'active' : ''}`} onClick={() => setActiveTab('budget')}>üíµ Budget</button>
                        <button className={`tab-button ${activeTab === 'transactions' ? 'active' : ''}`} onClick={() => setActiveTab('transactions')}>üí≥ Transactions</button>
                        <button className={`tab-button ${activeTab === 'recurring' ? 'active' : ''}`} onClick={() => setActiveTab('recurring')}>üîÑ Recurring</button>
                        <button className={`tab-button ${activeTab === 'debts' ? 'active' : ''}`} onClick={() => setActiveTab('debts')}>üí∏ Debts</button>
                        <button className={`tab-button ${activeTab === 'settings' ? 'active' : ''}`} onClick={() => setActiveTab('settings')}>‚öôÔ∏è Settings</button>
                    </div>

                    <div className="tab-content">
                        {activeTab === 'dashboard' && <DashboardTab transactions={transactions} recurringPayments={recurringPayments} debts={debts} formatCurrency={formatCurrency} getFinancialMonth={getFinancialMonth} getFinancialMonthRange={getFinancialMonthRange} />}
                        {activeTab === 'budget' && <BudgetTab transactions={transactions} recurringPayments={recurringPayments} expectedMonthlyIncome={expectedMonthlyIncome} setExpectedMonthlyIncome={setExpectedMonthlyIncome} formatCurrency={formatCurrency} getFinancialMonth={getFinancialMonth} getFinancialMonthRange={getFinancialMonthRange} />}
                        {activeTab === 'transactions' && <TransactionsTab transactions={transactions} addTransaction={addTransaction} updateTransaction={updateTransaction} deleteTransaction={deleteTransaction} formatCurrency={formatCurrency} getFinancialMonth={getFinancialMonth} />}
                        {activeTab === 'recurring' && <RecurringTab recurringPayments={recurringPayments} addRecurringPayment={addRecurringPayment} updateRecurringPayment={updateRecurringPayment} deleteRecurringPayment={deleteRecurringPayment} debts={debts} formatCurrency={formatCurrency} />}
                        {activeTab === 'debts' && <DebtsTab debts={debts} addDebt={addDebt} updateDebt={updateDebt} deleteDebt={deleteDebt} formatCurrency={formatCurrency} />}
                        {activeTab === 'settings' && <SettingsTab exportData={exportData} importData={importData} clearAllData={clearAllData} />}
                    </div>
                </div>
            );
        }

        function DashboardTab({ transactions, recurringPayments, debts, formatCurrency, getFinancialMonth, getFinancialMonthRange }) {
            const [selectedCategory, setSelectedCategory] = useState('All');
            const [debtsCollapsed, setDebtsCollapsed] = useState(false);

            const currentYear = new Date().getFullYear();
            const yearTransactions = transactions.filter(t => new Date(t.date).getFullYear() === currentYear);

            const totalIncome = yearTransactions.filter(t => t.category === 'Income').reduce((sum, t) => sum + t.amount, 0);
            const totalExpenses = yearTransactions.filter(t => t.category !== 'Income').reduce((sum, t) => sum + t.amount, 0);
            const netIncome = totalIncome - totalExpenses;

            const currentMonth = getFinancialMonth(new Date());
            const { start, end } = getFinancialMonthRange(currentMonth);
            const monthTransactions = transactions.filter(t => {
                const tDate = new Date(t.date);
                return tDate >= start && tDate <= end;
            });

            const filteredTransactions = selectedCategory === 'All' 
                ? monthTransactions 
                : monthTransactions.filter(t => t.category === selectedCategory);

            const monthIncome = monthTransactions.filter(t => t.category === 'Income').reduce((sum, t) => sum + t.amount, 0);
            const monthExpenses = monthTransactions.filter(t => t.category !== 'Income').reduce((sum, t) => sum + t.amount, 0);

            const categoryTotals = {};
            monthTransactions.filter(t => t.category !== 'Income').forEach(t => {
                categoryTotals[t.category] = (categoryTotals[t.category] || 0) + t.amount;
            });

            const totalDebt = debts.reduce((sum, d) => sum + d.balance, 0);

            return (
                <div>
                    <div className="summary-grid">
                        <div className="yearly-overview income">
                            <h2>Yearly Income</h2>
                            <div className="amount">{formatCurrency(totalIncome)}</div>
                            <p style={{color: '#a0aec0'}}>{currentYear}</p>
                        </div>
                        <div className="yearly-overview expense">
                            <h2>Yearly Expenses</h2>
                            <div className="amount">{formatCurrency(totalExpenses)}</div>
                            <p style={{color: '#a0aec0'}}>{currentYear}</p>
                        </div>
                        <div className="yearly-overview net">
                            <h2>Net Income</h2>
                            <div className={`amount ${netIncome >= 0 ? 'positive' : 'negative'}`}>{formatCurrency(netIncome)}</div>
                            <p style={{color: '#a0aec0'}}>{currentYear}</p>
                        </div>
                    </div>

                    <div className="dashboard-grid">
                        <div className="summary-card">
                            <h3>This Month Income</h3>
                            <div className="amount">{formatCurrency(monthIncome)}</div>
                            <div className="subtitle">{currentMonth}</div>
                        </div>
                        <div className="summary-card">
                            <h3>This Month Expenses</h3>
                            <div className="amount">{formatCurrency(monthExpenses)}</div>
                            <div className="subtitle">{currentMonth}</div>
                        </div>
                    </div>

                    <div className="collapsible-section">
                        <div className="collapsible-header" onClick={() => setDebtsCollapsed(!debtsCollapsed)}>
                            <h3>üí∏ Debt Overview - Total: {formatCurrency(totalDebt)}</h3>
                            <span style={{fontSize: '1.5em'}}>{debtsCollapsed ? '‚ñº' : '‚ñ≤'}</span>
                        </div>
                        {!debtsCollapsed && (
                            <div className="collapsible-content">
                                <div className="debt-overview-grid">
                                    {debts.map(debt => (
                                        <div key={debt.id} className="debt-mini-card">
                                            <h4>{debt.name}</h4>
                                            <div className="debt-amount">{formatCurrency(debt.balance)}</div>
                                            <div className="debt-info">APR: {debt.apr}%</div>
                                            <div className="debt-info">Min Payment: {formatCurrency(debt.minPayment)}</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="section">
                        <h2>Current Month Spending by Category</h2>
                        <div className="category-filters">
                            <button className={`category-filter-btn ${selectedCategory === 'All' ? 'active' : ''}`} onClick={() => setSelectedCategory('All')}>All</button>
                            {CATEGORIES.filter(c => c !== 'Income').map(category => (
                                <button key={category} className={`category-filter-btn ${selectedCategory === category ? 'active' : ''}`} onClick={() => setSelectedCategory(category)}>
                                    {category} ({formatCurrency(categoryTotals[category] || 0)})
                                </button>
                            ))}
                        </div>
                        
                        <div className="transaction-list">
                            {filteredTransactions.length === 0 ? (
                                <p style={{textAlign: 'center', color: '#a0aec0', padding: '40px'}}>No transactions for this category this month.</p>
                            ) : (
                                filteredTransactions.sort((a, b) => new Date(b.date) - new Date(a.date)).map(transaction => (
                                    <div key={transaction.id} className={`transaction-item ${transaction.category === 'Income' ? 'income' : 'expense'}`}>
                                        <div className="item-details">
                                            <h4>{transaction.description}</h4>
                                            <p>{new Date(transaction.date).toLocaleDateString()} ‚Ä¢ {transaction.category}</p>
                                        </div>
                                        <div className={`item-amount ${transaction.category === 'Income' ? 'positive' : 'negative'}`}>
                                            {transaction.category === 'Income' ? '+' : '-'}{formatCurrency(transaction.amount)}
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        function BudgetTab({ transactions, recurringPayments, expectedMonthlyIncome, setExpectedMonthlyIncome, formatCurrency, getFinancialMonth, getFinancialMonthRange }) {
            const [tempIncome, setTempIncome] = useState(expectedMonthlyIncome);

            const currentMonth = getFinancialMonth(new Date());
            const { start, end } = getFinancialMonthRange(currentMonth);
            
            const monthTransactions = transactions.filter(t => {
                const tDate = new Date(t.date);
                return tDate >= start && tDate <= end;
            });

            const actualIncome = monthTransactions
                .filter(t => t.category === 'Income')
                .reduce((sum, t) => sum + t.amount, 0);

            const recurringTotal = recurringPayments
                .filter(p => {
                    const dueDate = new Date(p.dueDate);
                    return dueDate >= start && dueDate <= end;
                })
                .reduce((sum, p) => sum + p.amount, 0);

            const discretionaryBudget = expectedMonthlyIncome - recurringTotal;

            const discretionarySpent = monthTransactions
                .filter(t => t.category !== 'Income' && !t.isRecurring)
                .reduce((sum, t) => sum + t.amount, 0);

            const remaining = discretionaryBudget - discretionarySpent;

            const handleSaveIncome = () => {
                setExpectedMonthlyIncome(tempIncome);
                alert('Expected monthly income updated!');
            };

            const startDate = new Date(start);
            const endDate = new Date(end);
            const monthLabel = `${startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - ${endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`;

            return (
                <div>
                    <div className="section">
                        <h2>üíµ Income Settings</h2>
                        <div className="income-input-group">
                            <div className="form-group">
                                <label>Expected Monthly Income</label>
                                <input 
                                    type="number" 
                                    value={tempIncome} 
                                    onChange={(e) => setTempIncome(Number(e.target.value))}
                                    placeholder="Enter expected monthly income"
                                />
                            </div>
                            <button onClick={handleSaveIncome}>üíæ Save</button>
                        </div>
                    </div>

                    <div className="budget-overview">
                        <h2 style={{color: '#667eea', marginBottom: '25px', fontSize: '1.8em'}}>üí∞ Money Available This Month</h2>
                        <p style={{color: '#a0aec0', marginBottom: '20px', fontSize: '0.95em'}}>Current Month: {monthLabel}</p>
                        
                        <div className="budget-row">
                            <span className="budget-label">Expected Income:</span>
                            <span className="budget-value">{formatCurrency(expectedMonthlyIncome)}</span>
                        </div>
                        
                        <div className="budget-row">
                            <span className="budget-label">Actual Income (so far):</span>
                            <span className={`budget-value ${actualIncome >= expectedMonthlyIncome ? 'positive' : 'warning'}`}>
                                {formatCurrency(actualIncome)} {actualIncome < expectedMonthlyIncome && '‚ö†Ô∏è'}
                            </span>
                        </div>
                        
                        <div className="budget-row">
                            <span className="budget-label">Recurring Bills:</span>
                            <span className="budget-value negative">-{formatCurrency(recurringTotal)}</span>
                        </div>
                        
                        <div className="budget-row" style={{borderTop: '2px solid #667eea', paddingTop: '15px', marginTop: '10px'}}>
                            <span className="budget-label" style={{color: '#e2e8f0'}}>Discretionary Budget:</span>
                            <span className="budget-value">{formatCurrency(discretionaryBudget)}</span>
                        </div>
                        
                        <div className="budget-row">
                            <span className="budget-label">Discretionary Spent:</span>
                            <span className="budget-value negative">-{formatCurrency(discretionarySpent)}</span>
                        </div>
                        
                        <div className="budget-row total">
                            <span className="budget-label total">Remaining Available:</span>
                            <span className={`budget-value ${remaining >= 0 ? 'positive' : 'negative'}`}>
                                {formatCurrency(remaining)} {remaining >= 0 ? '‚úì' : '‚ö†Ô∏è'}
                            </span>
                        </div>
                    </div>

                    <div className="section">
                        <h2>üìä Budget Breakdown</h2>
                        <p style={{color: '#a0aec0', marginBottom: '20px', lineHeight: '1.6'}}>
                            <strong style={{color: '#e2e8f0'}}>Discretionary spending</strong> includes all transactions except Income and recurring payments (auto-pay items).
                            This shows money you've actively spent beyond your regular bills.
                        </p>
                        
                        <div style={{background: '#1a1f2e', padding: '20px', borderRadius: '10px'}}>
                            <div style={{marginBottom: '15px'}}>
                                <strong style={{color: '#667eea'}}>Expected Income:</strong>
                                <p style={{color: '#a0aec0', fontSize: '0.9em', marginTop: '5px'}}>
                                    The amount you expect to earn this month. Set this in the Income Settings above.
                                </p>
                            </div>
                            
                            <div style={{marginBottom: '15px'}}>
                                <strong style={{color: '#667eea'}}>Actual Income:</strong>
                                <p style={{color: '#a0aec0', fontSize: '0.9em', marginTop: '5px'}}>
                                    Sum of all Income transactions recorded this month so far.
                                </p>
                            </div>
                            
                            <div style={{marginBottom: '15px'}}>
                                <strong style={{color: '#667eea'}}>Recurring Bills:</strong>
                                <p style={{color: '#a0aec0', fontSize: '0.9em', marginTop: '5px'}}>
                                    Total of all recurring payments due this month (from Recurring tab).
                                </p>
                            </div>
                            
                            <div style={{marginBottom: '15px'}}>
                                <strong style={{color: '#667eea'}}>Discretionary Spent:</strong>
                                <p style={{color: '#a0aec0', fontSize: '0.9em', marginTop: '5px'}}>
                                    Money spent on non-recurring items (excludes auto-pay transactions to avoid double-counting).
                                </p>
                            </div>
                            
                            <div>
                                <strong style={{color: '#667eea'}}>Remaining Available:</strong>
                                <p style={{color: '#a0aec0', fontSize: '0.9em', marginTop: '5px'}}>
                                    This is your "money left to spend" after all bills and discretionary purchases. Green means you're under budget, red means you've overspent.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function TransactionsTab({ transactions, addTransaction, updateTransaction, deleteTransaction, formatCurrency, getFinancialMonth }) {
            const [formData, setFormData] = useState({ date: new Date().toISOString().split('T')[0], description: '', amount: '', category: 'Food' });
            const [editingId, setEditingId] = useState(null);
            const [selectedMonth, setSelectedMonth] = useState('All');

            const months = ['All', ...new Set(transactions.map(t => getFinancialMonth(t.date)))].sort().reverse();

            const filteredTransactions = selectedMonth === 'All' 
                ? transactions 
                : transactions.filter(t => getFinancialMonth(t.date) === selectedMonth);

            const handleSubmit = (e) => {
                e.preventDefault();
                if (editingId) {
                    updateTransaction(editingId, formData);
                    setEditingId(null);
                } else {
                    addTransaction(formData);
                }
                setFormData({ date: new Date().toISOString().split('T')[0], description: '', amount: '', category: 'Food' });
            };

            const handleEdit = (transaction) => {
                setFormData(transaction);
                setEditingId(transaction.id);
            };

            const handleCancel = () => {
                setFormData({ date: new Date().toISOString().split('T')[0], description: '', amount: '', category: 'Food' });
                setEditingId(null);
            };

            return (
                <div>
                    <div className="section">
                        <h2>{editingId ? '‚úèÔ∏è Edit Transaction' : '‚ûï Add Transaction'}</h2>
                        <form onSubmit={handleSubmit}>
                            <div className="form-row">
                                <div className="form-group">
                                    <label>Date</label>
                                    <input type="date" value={formData.date} onChange={(e) => setFormData({...formData, date: e.target.value})} required />
                                </div>
                                <div className="form-group">
                                    <label>Description</label>
                                    <input type="text" value={formData.description} onChange={(e) => setFormData({...formData, description: e.target.value})} required />
                                </div>
                                <div className="form-group">
                                    <label>Amount ($)</label>
                                    <input type="number" step="0.01" value={formData.amount} onChange={(e) => setFormData({...formData, amount: parseFloat(e.target.value)})} required />
                                </div>
                                <div className="form-group">
                                    <label>Category</label>
                                    <select value={formData.category} onChange={(e) => setFormData({...formData, category: e.target.value})}>
                                        {CATEGORIES.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                    </select>
                                </div>
                            </div>
                            <div className="controls">
                                <button type="submit">{editingId ? 'üíæ Update' : '‚ûï Add'} Transaction</button>
                                {editingId && <button type="button" className="secondary" onClick={handleCancel}>Cancel</button>}
                            </div>
                        </form>
                    </div>

                    <div className="section">
                        <h2>Transaction History</h2>
                        <div className="category-filters">
                            {months.map(month => (
                                <button key={month} className={`category-filter-btn ${selectedMonth === month ? 'active' : ''}`} onClick={() => setSelectedMonth(month)}>{month}</button>
                            ))}
                        </div>
                        
                        <div className="transaction-list">
                            {filteredTransactions.sort((a, b) => new Date(b.date) - new Date(a.date)).map(transaction => (
                                <div key={transaction.id} className={`transaction-item ${transaction.category === 'Income' ? 'income' : 'expense'}`}>
                                    <div className="item-details">
                                        <h4>
                                            {transaction.description}
                                            {transaction.isRecurring && <span className="auto-badge">AUTO</span>}
                                        </h4>
                                        <p>{new Date(transaction.date).toLocaleDateString()} ‚Ä¢ {transaction.category}</p>
                                    </div>
                                    <div style={{display: 'flex', alignItems: 'center', gap: '15px'}}>
                                        <div className={`item-amount ${transaction.category === 'Income' ? 'positive' : 'negative'}`}>
                                            {transaction.category === 'Income' ? '+' : '-'}{formatCurrency(transaction.amount)}
                                        </div>
                                        <button className="secondary" onClick={() => handleEdit(transaction)} style={{padding: '8px 15px'}}>Edit</button>
                                        <button className="danger" onClick={() => deleteTransaction(transaction.id)} style={{padding: '8px 15px'}}>Delete</button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        function RecurringTab({ recurringPayments, addRecurringPayment, updateRecurringPayment, deleteRecurringPayment, debts, formatCurrency }) {
            const [formData, setFormData] = useState({ description: '', amount: '', category: 'Food', dueDate: new Date().toISOString().split('T')[0], autoPay: false, linkedDebtId: null });
            const [editingId, setEditingId] = useState(null);
            const [collapsedSections, setCollapsedSections] = useState({});

            const toggleSection = (category) => {
                setCollapsedSections(prev => ({ ...prev, [category]: !prev[category] }));
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                const paymentData = {
                    ...formData,
                    linkedDebtId: formData.linkedDebtId === 'none' ? null : formData.linkedDebtId,
                    paid: false
                };
                if (editingId) {
                    updateRecurringPayment(editingId, paymentData);
                    setEditingId(null);
                } else {
                    addRecurringPayment(paymentData);
                }
                setFormData({ description: '', amount: '', category: 'Food', dueDate: new Date().toISOString().split('T')[0], autoPay: false, linkedDebtId: null });
            };

            const handleEdit = (payment) => {
                setFormData({
                    description: payment.description,
                    amount: payment.amount,
                    category: payment.category,
                    dueDate: payment.dueDate,
                    autoPay: payment.autoPay || false,
                    linkedDebtId: payment.linkedDebtId || 'none'
                });
                setEditingId(payment.id);
            };

            const handleCancel = () => {
                setFormData({ description: '', amount: '', category: 'Food', dueDate: new Date().toISOString().split('T')[0], autoPay: false, linkedDebtId: null });
                setEditingId(null);
            };

            const handleMarkPaid = (id) => {
                const payment = recurringPayments.find(p => p.id === id);
                updateRecurringPayment(id, { ...payment, paid: true });
            };

            const handleReset = (id) => {
                const payment = recurringPayments.find(p => p.id === id);
                updateRecurringPayment(id, { ...payment, paid: false });
            };

            const groupedPayments = recurringPayments.reduce((acc, payment) => {
                if (!acc[payment.category]) acc[payment.category] = [];
                acc[payment.category].push(payment);
                return acc;
            }, {});

            return (
                <div>
                    <div className="section">
                        <h2>{editingId ? '‚úèÔ∏è Edit Recurring Payment' : '‚ûï Add Recurring Payment'}</h2>
                        <form onSubmit={handleSubmit}>
                            <div className="form-row">
                                <div className="form-group">
                                    <label>Description</label>
                                    <input type="text" value={formData.description} onChange={(e) => setFormData({...formData, description: e.target.value})} required />
                                </div>
                                <div className="form-group">
                                    <label>Amount ($)</label>
                                    <input type="number" step="0.01" value={formData.amount} onChange={(e) => setFormData({...formData, amount: parseFloat(e.target.value)})} required />
                                </div>
                                <div className="form-group">
                                    <label>Category</label>
                                    <select value={formData.category} onChange={(e) => setFormData({...formData, category: e.target.value})}>
                                        {CATEGORIES.filter(c => c !== 'Income').map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                    </select>
                                </div>
                                <div className="form-group">
                                    <label>Due Date</label>
                                    <input type="date" value={formData.dueDate} onChange={(e) => setFormData({...formData, dueDate: e.target.value})} required />
                                </div>
                            </div>
                            <div className="form-row">
                                <div className="form-group">
                                    <label>Link to Debt (Optional)</label>
                                    <select value={formData.linkedDebtId || 'none'} onChange={(e) => setFormData({...formData, linkedDebtId: e.target.value === 'none' ? null : parseInt(e.target.value)})}>
                                        <option value="none">None</option>
                                        {debts.map(debt => <option key={debt.id} value={debt.id}>{debt.name}</option>)}
                                    </select>
                                </div>
                                <div className="form-group" style={{display: 'flex', alignItems: 'center', gap: '10px', marginTop: '28px'}}>
                                    <input type="checkbox" id="autoPay" checked={formData.autoPay} onChange={(e) => setFormData({...formData, autoPay: e.target.checked})} style={{width: 'auto'}} />
                                    <label htmlFor="autoPay" style={{marginBottom: 0}}>Auto-pay when due</label>
                                </div>
                            </div>
                            <div className="controls">
                                <button type="submit">{editingId ? 'üíæ Update' : '‚ûï Add'} Payment</button>
                                {editingId && <button type="button" className="secondary" onClick={handleCancel}>Cancel</button>}
                            </div>
                        </form>
                    </div>

                    {Object.keys(groupedPayments).map(category => (
                        <div key={category} className="collapsible-section">
                            <div className="collapsible-header" onClick={() => toggleSection(category)}>
                                <h3>{category} ({groupedPayments[category].length} payments)</h3>
                                <span style={{fontSize: '1.5em'}}>{collapsedSections[category] ? '‚ñº' : '‚ñ≤'}</span>
                            </div>
                            {!collapsedSections[category] && (
                                <div className="collapsible-content">
                                    <div className="payment-list">
                                        {groupedPayments[category].sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate)).map(payment => (
                                            <div key={payment.id} className={`payment-item ${payment.paid ? 'paid' : 'unpaid'}`}>
                                                <div className="item-details">
                                                    <h4>
                                                        {payment.description}
                                                        {payment.paid && <span className="paid-badge">PAID</span>}
                                                        {payment.autoPay && <span className="auto-badge">AUTO</span>}
                                                    </h4>
                                                    <p>
                                                        Due: {new Date(payment.dueDate).toLocaleDateString()}
                                                        {payment.linkedDebtId && ` ‚Ä¢ Linked to: ${debts.find(d => d.id === payment.linkedDebtId)?.name}`}
                                                    </p>
                                                </div>
                                                <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}>
                                                    <div className="item-amount negative">{formatCurrency(payment.amount)}</div>
                                                    {!payment.paid && !payment.autoPay && <button className="success" onClick={() => handleMarkPaid(payment.id)} style={{padding: '8px 15px'}}>Mark Paid</button>}
                                                    {payment.paid && <button className="secondary" onClick={() => handleReset(payment.id)} style={{padding: '8px 15px'}}>Reset</button>}
                                                    <button className="secondary" onClick={() => handleEdit(payment)} style={{padding: '8px 15px'}}>Edit</button>
                                                    <button className="danger" onClick={() => deleteRecurringPayment(payment.id)} style={{padding: '8px 15px'}}>Delete</button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    ))}
                </div>
            );
        }

        function DebtsTab({ debts, addDebt, updateDebt, deleteDebt, formatCurrency }) {
            const [formData, setFormData] = useState({ name: '', balance: '', apr: '', minPayment: '' });
            const [editingId, setEditingId] = useState(null);
            const [expandedDebt, setExpandedDebt] = useState(null);

            const handleSubmit = (e) => {
                e.preventDefault();
                if (editingId) {
                    updateDebt(editingId, formData);
                    setEditingId(null);
                } else {
                    addDebt(formData);
                }
                setFormData({ name: '', balance: '', apr: '', minPayment: '' });
            };

            const handleEdit = (debt) => {
                setFormData({ name: debt.name, balance: debt.balance, apr: debt.apr, minPayment: debt.minPayment });
                setEditingId(debt.id);
            };

            const handleCancel = () => {
                setFormData({ name: '', balance: '', apr: '', minPayment: '' });
                setEditingId(null);
            };

            const calculatePayoffTimeline = (debt, strategy) => {
                let balance = debt.balance;
                let month = 0;
                const timeline = [];
                const monthlyRate = debt.apr / 100 / 12;

                while (balance > 0 && month < 600) {
                    const interest = balance * monthlyRate;
                    const principal = Math.min(debt.minPayment - interest, balance);
                    balance -= principal;
                    month++;
                    
                    if (month % 12 === 0 || balance <= 0) {
                        timeline.push({
                            month,
                            balance: Math.max(balance, 0),
                            totalPaid: month * debt.minPayment
                        });
                    }
                }

                return timeline;
            };

            return (
                <div>
                    <div className="section">
                        <h2>{editingId ? '‚úèÔ∏è Edit Debt' : '‚ûï Add Debt'}</h2>
                        <form onSubmit={handleSubmit}>
                            <div className="form-row">
                                <div className="form-group">
                                    <label>Debt Name</label>
                                    <input type="text" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} required />
                                </div>
                                <div className="form-group">
                                    <label>Current Balance ($)</label>
                                    <input type="number" step="0.01" value={formData.balance} onChange={(e) => setFormData({...formData, balance: parseFloat(e.target.value)})} required />
                                </div>
                                <div className="form-group">
                                    <label>APR (%)</label>
                                    <input type="number" step="0.01" value={formData.apr} onChange={(e) => setFormData({...formData, apr: parseFloat(e.target.value)})} required />
                                </div>
                                <div className="form-group">
                                    <label>Minimum Payment ($)</label>
                                    <input type="number" step="0.01" value={formData.minPayment} onChange={(e) => setFormData({...formData, minPayment: parseFloat(e.target.value)})} required />
                                </div>
                            </div>
                            <div className="controls">
                                <button type="submit">{editingId ? 'üíæ Update' : '‚ûï Add'} Debt</button>
                                {editingId && <button type="button" className="secondary" onClick={handleCancel}>Cancel</button>}
                            </div>
                        </form>
                    </div>

                    <div className="section">
                        <h2>Debt Management</h2>
                        <div className="debt-list">
                            {debts.map(debt => {
                                const timeline = calculatePayoffTimeline(debt);
                                const payoffMonths = timeline[timeline.length - 1]?.month || 0;
                                const totalInterest = timeline[timeline.length - 1]?.totalPaid - debt.balance || 0;
                                const isExpanded = expandedDebt === debt.id;

                                return (
                                    <div key={debt.id}>
                                        <div className="debt-item" onClick={() => setExpandedDebt(isExpanded ? null : debt.id)} style={{cursor: 'pointer'}}>
                                            <div className="item-details" style={{flex: 1}}>
                                                <h4>{debt.name}</h4>
                                                <p>Balance: {formatCurrency(debt.balance)} ‚Ä¢ APR: {debt.apr}% ‚Ä¢ Min Payment: {formatCurrency(debt.minPayment)}</p>
                                                <div className="progress-bar">
                                                    <div className="progress-fill" style={{width: `${Math.min((debt.minPayment / debt.balance) * 100, 100)}%`}}></div>
                                                </div>
                                                <p style={{marginTop: '8px', fontSize: '0.85em'}}>Payoff: {Math.floor(payoffMonths / 12)}y {payoffMonths % 12}m ‚Ä¢ Total Interest: {formatCurrency(totalInterest)}</p>
                                            </div>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}>
                                                <button className="secondary" onClick={(e) => { e.stopPropagation(); handleEdit(debt); }} style={{padding: '8px 15px'}}>Edit</button>
                                                <button className="danger" onClick={(e) => { e.stopPropagation(); deleteDebt(debt.id); }} style={{padding: '8px 15px'}}>Delete</button>
                                                <span style={{fontSize: '1.5em', color: '#667eea'}}>{isExpanded ? '‚ñ≤' : '‚ñº'}</span>
                                            </div>
                                        </div>

                                        {isExpanded && (
                                            <div style={{background: '#0f1419', padding: '25px', borderRadius: '0 0 10px 10px', marginTop: '2px'}}>
                                                <h3 style={{color: '#667eea', marginBottom: '20px'}}>Debt Details</h3>
                                                <div className="debt-details">
                                                    <div className="debt-detail-item">
                                                        <label>Current Balance</label>
                                                        <div className="value">{formatCurrency(debt.balance)}</div>
                                                    </div>
                                                    <div className="debt-detail-item">
                                                        <label>APR</label>
                                                        <div className="value">{debt.apr}%</div>
                                                    </div>
                                                    <div className="debt-detail-item">
                                                        <label>Monthly Payment</label>
                                                        <div className="value">{formatCurrency(debt.minPayment)}</div>
                                                    </div>
                                                    <div className="debt-detail-item">
                                                        <label>Monthly Interest</label>
                                                        <div className="value">{formatCurrency(debt.balance * (debt.apr / 100) / 12)}</div>
                                                    </div>
                                                    <div className="debt-detail-item">
                                                        <label>Payoff Time</label>
                                                        <div className="value">{Math.floor(payoffMonths / 12)}y {payoffMonths % 12}m</div>
                                                    </div>
                                                    <div className="debt-detail-item">
                                                        <label>Total Interest</label>
                                                        <div className="value">{formatCurrency(totalInterest)}</div>
                                                    </div>
                                                </div>

                                                {debt.transactions && debt.transactions.length > 0 && (
                                                    <>
                                                        <h3 style={{color: '#667eea', marginTop: '30px', marginBottom: '15px'}}>Transaction History</h3>
                                                        <div style={{overflowX: 'auto'}}>
                                                            <table style={{width: '100%', borderCollapse: 'collapse'}}>
                                                                <thead>
                                                                    <tr style={{borderBottom: '2px solid #2d3748'}}>
                                                                        <th style={{padding: '12px', textAlign: 'left', color: '#a0aec0'}}>Date</th>
                                                                        <th style={{padding: '12px', textAlign: 'right', color: '#a0aec0'}}>Payment</th>
                                                                        <th style={{padding: '12px', textAlign: 'right', color: '#a0aec0'}}>Interest</th>
                                                                        <th style={{padding: '12px', textAlign: 'right', color: '#a0aec0'}}>Principal</th>
                                                                        <th style={{padding: '12px', textAlign: 'right', color: '#a0aec0'}}>Balance Before</th>
                                                                        <th style={{padding: '12px', textAlign: 'right', color: '#a0aec0'}}>Balance After</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    {debt.transactions.map((trans, idx) => (
                                                                        <tr key={idx} style={{borderBottom: '1px solid #2d3748'}}>
                                                                            <td style={{padding: '12px', color: '#e2e8f0'}}>{new Date(trans.date).toLocaleDateString()}</td>
                                                                            <td style={{padding: '12px', textAlign: 'right', color: '#e2e8f0'}}>{formatCurrency(trans.payment)}</td>
                                                                            <td style={{padding: '12px', textAlign: 'right', color: '#dc3545'}}>{formatCurrency(trans.interest)}</td>
                                                                            <td style={{padding: '12px', textAlign: 'right', color: '#28a745'}}>{formatCurrency(trans.principal)}</td>
                                                                            <td style={{padding: '12px', textAlign: 'right', color: '#a0aec0'}}>{formatCurrency(trans.balanceBefore)}</td>
                                                                            <td style={{padding: '12px', textAlign: 'right', color: '#e2e8f0', fontWeight: 700}}>{formatCurrency(trans.balanceAfter)}</td>
                                                                        </tr>
                                                                    ))}
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </>
                                                )}
                                            </div>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        }

        function SettingsTab({ exportData, importData, clearAllData }) {
            return (
                <div>
                    <div className="section" style={{background: 'linear-gradient(135deg, #667eea22 0%, #764ba222 100%)', border: '2px solid #667eea', padding: '25px'}}>
                        <h2 style={{color: '#667eea', marginBottom: '15px'}}>‚ö° Important: No Auto-Save</h2>
                        <p style={{color: '#e2e8f0', fontSize: '1.05em', lineHeight: '1.8', marginBottom: '15px'}}>
                            <strong>This app does NOT use localStorage.</strong> Your data exists only in memory during your session.
                        </p>
                        <div style={{background: '#0f1419', padding: '20px', borderRadius: '10px'}}>
                            <h3 style={{color: '#667eea', marginBottom: '10px'}}>üìã Your Workflow:</h3>
                            <ol style={{color: '#a0aec0', lineHeight: '2', marginLeft: '20px'}}>
                                <li><strong style={{color: '#e2e8f0'}}>Start:</strong> Import your JSON file</li>
                                <li><strong style={{color: '#e2e8f0'}}>Work:</strong> Add transactions, process payments, etc.</li>
                                <li><strong style={{color: '#e2e8f0'}}>End:</strong> Export to save your changes</li>
                                <li><strong style={{color: '#e2e8f0'}}>Next time:</strong> Import the latest export to continue</li>
                            </ol>
                        </div>
                        <p style={{color: '#ffc107', fontSize: '0.95em', marginTop: '15px', fontWeight: '600'}}>
                            ‚ö†Ô∏è Closing/refreshing the page without exporting = data is lost!
                        </p>
                    </div>
                    <div className="section">
                        <h2>Data Management</h2>
                        <div className="controls">
                            <button onClick={exportData}>üíæ Export Data</button>
                            <label style={{background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: 'white', padding: '12px 30px', borderRadius: '8px', cursor: 'pointer', fontWeight: 600, display: 'inline-block'}}>üìÅ Import Data<input type="file" accept=".json" onChange={importData} style={{display: 'none'}} /></label>
                            <button className="danger" onClick={clearAllData}>üóëÔ∏è Clear All Data</button>
                        </div>
                        <p style={{marginTop: '20px', color: '#a0aec0', fontSize: '0.9em'}}>Export your data to save a backup, import previously exported data, or clear all data to start fresh.</p>
                    </div>
                    <div className="section">
                        <h2>What's New in v1.10.0</h2>
                        <div style={{background: '#1a1f2e', padding: '20px', borderRadius: '10px', marginBottom: '20px'}}>
                            <h3 style={{color: '#667eea', marginBottom: '15px'}}>üíµ Budget Tab - Money Available Tracking</h3>
                            <ul style={{color: '#a0aec0', lineHeight: '1.8', marginLeft: '20px'}}>
                                <li>Set your expected monthly income</li>
                                <li>See actual income received vs expected</li>
                                <li>View total recurring bills for the month</li>
                                <li>Track discretionary spending (non-recurring expenses)</li>
                                <li>Know exactly how much money you have left to spend</li>
                            </ul>
                        </div>
                        
                        <div style={{background: '#1a1f2e', padding: '20px', borderRadius: '10px', marginBottom: '20px'}}>
                            <h3 style={{color: '#667eea', marginBottom: '15px'}}>üîß Technical Improvements</h3>
                            <ul style={{color: '#a0aec0', lineHeight: '1.8', marginLeft: '20px'}}>
                                <li>Auto-transactions now flagged with <span style={{background: '#17a2b8', color: 'white', padding: '2px 8px', borderRadius: '8px', fontSize: '0.8em'}}>AUTO</span> badge</li>
                                <li>Prevents double-counting of recurring payments in budget calculations</li>
                                <li>Debt tracking section now collapsible on Dashboard for cleaner layout</li>
                                <li>Expected income setting saved with export/import</li>
                            </ul>
                        </div>
                    </div>
                    <div className="section">
                        <h2>How to Use Finance Tracker</h2>
                        <p style={{marginBottom: '20px', lineHeight: '1.6', color: '#a0aec0'}}>Quick guide to get the most out of your finance tracker.</p>
                        
                        <h3 style={{marginTop: '20px', marginBottom: '10px', color: '#667eea'}}>üíµ Budget Tab</h3>
                        <p style={{marginBottom: '10px', lineHeight: '1.6', color: '#a0aec0'}}>
                            <strong>What it does:</strong> Shows you how much discretionary money you have available after income and recurring bills.<br/>
                            <strong>How to use:</strong> Set your expected monthly income, then track your spending to see remaining available funds.<br/>
                            <strong>Key insight:</strong> Green remaining balance = you're on track. Red = overspending alert!
                        </p>
                        
                        <h3 style={{marginTop: '20px', marginBottom: '10px', color: '#667eea'}}>üîÑ Auto-Pay Recurring Payments</h3>
                        <p style={{marginBottom: '10px', lineHeight: '1.6', color: '#a0aec0'}}>
                            <strong>What it does:</strong> Automatically creates transactions when the due date passes.<br/>
                            <strong>How to enable:</strong> When adding/editing a recurring payment, check the "Auto-pay" checkbox.<br/>
                            <strong>How it works:</strong> On the due date, a transaction is created automatically and the payment is marked as paid.
                        </p>
                        
                        <h3 style={{marginTop: '20px', marginBottom: '10px', color: '#667eea'}}>üí≥ Linking Payments to Debts</h3>
                        <p style={{marginBottom: '10px', lineHeight: '1.6', color: '#a0aec0'}}>
                            <strong>What it does:</strong> Updates debt balance and tracks interest/principal breakdown.<br/>
                            <strong>How to link:</strong> When adding/editing a recurring payment, select a debt from the "Link to Debt" dropdown.<br/>
                            <strong>What you get:</strong> Automatic balance updates + transaction history showing exactly how each payment reduces your debt.
                        </p>
                        
                        <h3 style={{marginTop: '20px', marginBottom: '10px', color: '#667eea'}}>üìä Debt Transaction Logs</h3>
                        <p style={{marginBottom: '10px', lineHeight: '1.6', color: '#a0aec0'}}>
                            <strong>Where to find:</strong> Go to Debts tab, Click on a debt to expand, Scroll to "Transaction History".<br/>
                            <strong>What it shows:</strong> Date, payment amount, interest charged, principal paid, and balance before/after.<br/>
                            <strong>Note:</strong> Only shows for debts with linked recurring payments that have been processed.
                        </p>
                        
                        <h3 style={{marginTop: '20px', marginBottom: '10px', color: '#667eea'}}>üìÖ Financial Month (28th-27th Cycle)</h3>
                        <p style={{marginBottom: '10px', lineHeight: '1.6', color: '#a0aec0'}}>
                            <strong>How it works:</strong> Financial months run from the 28th of one month through the 27th of the next.<br/>
                            <strong>Example:</strong> December 2025 = Nov 28 through Dec 27.<br/>
                            <strong>Why:</strong> Aligns with common payday cycles where bills are due early in the calendar month.
                        </p>
                        
                        <h3 style={{marginTop: '20px', marginBottom: '10px', color: '#667eea'}}>üíæ Export & Import</h3>
                        <p style={{marginBottom: '10px', lineHeight: '1.6', color: '#a0aec0'}}>
                            <strong>Export:</strong> Creates a backup JSON file with all your data (transactions, debts, recurring payments, settings).<br/>
                            <strong>Import:</strong> Restores data from a backup file.<br/>
                            <strong>Use case:</strong> Backup your data regularly, or move data between devices/browsers.
                        </p>
                        
                        <p style={{marginTop: '30px', padding: '15px', background: '#1a1f2e', borderRadius: '8px', color: '#667eea', fontSize: '0.9em'}}>
                            <strong>üí° Tip:</strong> All data is stored locally in your browser. No one else can see your financial information, even if they access the same URL.
                        </p>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<FinanceTracker />, document.getElementById('root'));
    </script>
</body>
</html>
