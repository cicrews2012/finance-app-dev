<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Finance Tracker v1.11.22</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
      color: #e2e8f0;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      backdrop-filter: blur(10px);
    }

    .version {
      color: #94a3b8;
      font-size: 0.9rem;
      margin-top: 5px;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .tab {
      padding: 12px 24px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid transparent;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      color: #94a3b8;
    }

    .tab:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
    }

    .tab.active {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      border-color: #60a5fa;
    }

    .section {
      background: rgba(255, 255, 255, 0.05);
      padding: 24px;
      border-radius: 12px;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      cursor: pointer;
      user-select: none;
    }

    .section-header h2 {
      font-size: 1.5rem;
      color: #60a5fa;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toggle-icon {
      transition: transform 0.3s ease;
      font-size: 1.2rem;
    }

    .toggle-icon.collapsed {
      transform: rotate(-90deg);
    }

    .section-content {
      max-height: 2000px;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .section-content.collapsed {
      max-height: 0;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    label {
      margin-bottom: 5px;
      color: #cbd5e1;
      font-size: 0.9rem;
    }

    input, select, textarea {
      padding: 10px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      color: #e2e8f0;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #60a5fa;
      background: rgba(255, 255, 255, 0.15);
    }

    input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    button {
      padding: 12px 24px;
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    button.delete {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    }

    button.delete:hover {
      box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3);
    }

    button.secondary {
      background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    }

    .button-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.08);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .stat-label {
      color: #94a3b8;
      font-size: 0.85rem;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #60a5fa;
    }

    .stat-value.positive {
      color: #34d399;
    }

    .stat-value.negative {
      color: #f87171;
    }

    .transaction-list, .debt-list, .recurring-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .transaction-item, .debt-item, .recurring-item {
      background: rgba(255, 255, 255, 0.08);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }

    .transaction-item:hover, .debt-item:hover, .recurring-item:hover {
      background: rgba(255, 255, 255, 0.12);
      transform: translateX(5px);
    }

    .item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .item-title {
      font-weight: 600;
      color: #e2e8f0;
      font-size: 1.1rem;
    }

    .item-amount {
      font-size: 1.2rem;
      font-weight: bold;
    }

    .item-amount.income {
      color: #34d399;
    }

    .item-amount.expense {
      color: #f87171;
    }

    .item-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .item-detail {
      display: flex;
      flex-direction: column;
    }

    .detail-label {
      font-size: 0.75rem;
      color: #94a3b8;
      margin-bottom: 2px;
    }

    .detail-value {
      color: #e2e8f0;
      font-size: 0.9rem;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #34d399 0%, #10b981 100%);
      transition: width 0.5s ease;
    }

    .search-bar {
      width: 100%;
      padding: 12px;
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      color: #e2e8f0;
      font-size: 1rem;
    }

    .filter-group {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .empty-state {
      text-align: center;
      padding: 40px;
      color: #94a3b8;
    }

    .data-management {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .calendar-view {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
      margin-top: 20px;
    }

    .calendar-day {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px;
      border-radius: 8px;
      min-height: 100px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .calendar-day-header {
      font-weight: bold;
      color: #60a5fa;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .calendar-day.today {
      border-color: #60a5fa;
      background: rgba(59, 130, 246, 0.1);
    }

    .calendar-payment {
      font-size: 0.75rem;
      padding: 4px;
      margin: 2px 0;
      background: rgba(59, 130, 246, 0.2);
      border-radius: 4px;
      border-left: 3px solid #60a5fa;
    }

    .calendar-payment.paid {
      background: rgba(52, 211, 153, 0.2);
      border-left-color: #34d399;
    }

    .calendar-payment.auto {
      background: rgba(168, 85, 247, 0.2);
      border-left-color: #a855f7;
    }

    .month-selector {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .month-selector button {
      padding: 8px 16px;
      font-size: 0.9rem;
    }

    .month-display {
      font-size: 1.2rem;
      font-weight: bold;
      color: #60a5fa;
    }

    @media (max-width: 768px) {
      .calendar-view {
        grid-template-columns: 1fr;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const VERSION = "1.11.22";

    function FinanceTracker() {
      const [activeTab, setActiveTab] = useState('dashboard');
      const [transactions, setTransactions] = useState([]);
      const [debts, setDebts] = useState([]);
      const [recurringPayments, setRecurringPayments] = useState([]);
      
      const [collapsedSections, setCollapsedSections] = useState({});
      
      const [searchTerm, setSearchTerm] = useState('');
      const [filterType, setFilterType] = useState('all');
      const [filterCategory, setFilterCategory] = useState('all');
      
      const [calendarMonth, setCalendarMonth] = useState(new Date());

      // Transaction form
      const [transactionForm, setTransactionForm] = useState({
        description: '',
        amount: '',
        type: 'expense',
        category: '',
        date: new Date().toISOString().split('T')[0],
        notes: ''
      });

      // Debt form
      const [debtForm, setDebtForm] = useState({
        name: '',
        originalBalance: '',
        currentBalance: '',
        interestRate: '',
        minimumPayment: '',
        dueDay: '',
        type: 'credit_card',
        notes: '',
        createRecurringPayment: false
      });

      // Recurring payment form
      const [recurringForm, setRecurringForm] = useState({
        name: '',
        amount: '',
        dayOfMonth: '',
        category: 'utilities',
        autoPay: false,
        linkedDebtId: null,
        notes: ''
      });

      const [editingDebt, setEditingDebt] = useState(null);
      const [editingRecurring, setEditingRecurring] = useState(null);

      // Load data from localStorage
      useEffect(() => {
        const savedTransactions = localStorage.getItem('transactions');
        const savedDebts = localStorage.getItem('debts');
        const savedRecurring = localStorage.getItem('recurringPayments');

        if (savedTransactions) setTransactions(JSON.parse(savedTransactions));
        if (savedDebts) setDebts(JSON.parse(savedDebts));
        if (savedRecurring) setRecurringPayments(JSON.parse(savedRecurring));
      }, []);

      // Save data to localStorage
      useEffect(() => {
        localStorage.setItem('transactions', JSON.stringify(transactions));
      }, [transactions]);

      useEffect(() => {
        localStorage.setItem('debts', JSON.stringify(debts));
      }, [debts]);

      useEffect(() => {
        localStorage.setItem('recurringPayments', JSON.stringify(recurringPayments));
      }, [recurringPayments]);

      // Auto-pay system - runs on load and when recurring payments change
      useEffect(() => {
        processAutoPay();
      }, []); // Only run on initial load

      const processAutoPay = () => {
        console.log('üöÄ AUTO-PAY SYSTEM RUNNING');
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        const currentFinanceMonth = getFinanceMonthForDate(today);
        console.log('Current month:', currentFinanceMonth);
        console.log('Transactions before:', transactions.length);
        console.log('Recurring payments:', recurringPayments.length);

        let updatedTransactions = [...transactions];
        let updatedDebts = [...debts];
        let hasChanges = false;
        let hasDebtChanges = false;

        recurringPayments.forEach(payment => {
          console.log(`\n--- Checking ${payment.name} ---`);
          
          if (!payment.autoPay) {
            console.log('  Skipped: Not auto-pay');
            return;
          }

          const paymentDate = getPaymentDateForMonth(payment.dayOfMonth, currentFinanceMonth);
          console.log('  Payment date:', paymentDate);
          console.log('  Today:', today);
          console.log('  Due date passed:', paymentDate <= today);

          if (paymentDate > today) {
            return; // Payment not due yet
          }

          // Check if transaction already exists for this month
          const existingTransaction = updatedTransactions.find(t => 
            t.recurringPaymentId === payment.id && 
            t.financeMonth === currentFinanceMonth.toISOString()
          );

          console.log('  Transaction exists:', !!existingTransaction);

          if (!existingTransaction) {
            // Create the transaction
            console.log('  ‚úÖ CREATING TRANSACTION');
            const newTransaction = {
              id: Date.now() + Math.random(),
              description: payment.name,
              amount: payment.amount,
              type: 'expense',
              category: payment.category,
              date: paymentDate.toISOString().split('T')[0],
              financeMonth: currentFinanceMonth.toISOString(),
              recurringPaymentId: payment.id,
              autoPaid: true,
              notes: payment.notes || 'Auto-generated from recurring payment'
            };
            updatedTransactions.push(newTransaction);
            console.log('  Created transaction:', newTransaction);
            hasChanges = true;

            // Update linked debt if applicable
            if (payment.linkedDebtId) {
              console.log('  Updating linked debt:', payment.linkedDebtId);
              const debtIndex = updatedDebts.findIndex(d => d.id === payment.linkedDebtId);
              if (debtIndex !== -1) {
                const debt = updatedDebts[debtIndex];
                const newBalance = debt.currentBalance - payment.amount;
                updatedDebts[debtIndex] = {
                  ...debt,
                  currentBalance: Math.max(0, newBalance)
                };
                hasDebtChanges = true;
              }
            }
          }

          // Mark recurring payment as paid for this month if not already
          const paymentIndex = recurringPayments.findIndex(p => p.id === payment.id);
          if (paymentIndex !== -1) {
            const currentPaidMonths = recurringPayments[paymentIndex].paidMonths || [];
            const monthKey = currentFinanceMonth.toISOString();
            
            if (!currentPaidMonths.includes(monthKey)) {
              // This will be handled by updating the recurringPayments state
              // We'll track this separately
            } else {
              console.log('  Already marked paid:', true);
            }
          }
        });

        console.log('\n--- Summary ---');
        console.log('Has transaction changes:', hasChanges);
        console.log('Has debt changes:', hasDebtChanges);
        console.log('New transactions count:', updatedTransactions.length);
        console.log('Transactions added:', updatedTransactions.length - transactions.length);

        if (hasChanges) {
          console.log('üíæ Saving transactions to state');
          setTransactions(updatedTransactions);
        }

        if (hasDebtChanges) {
          console.log('üíæ Saving debts to state');
          setDebts(updatedDebts);
        }
      };

      const getFinanceMonthForDate = (date) => {
        const d = new Date(date);
        const day = d.getDate();
        
        if (day >= 28) {
          return new Date(d.getFullYear(), d.getMonth(), 28);
        } else {
          const prevMonth = new Date(d.getFullYear(), d.getMonth() - 1, 28);
          return prevMonth;
        }
      };

      const getPaymentDateForMonth = (dayOfMonth, financeMonthStart) => {
        const monthStart = new Date(financeMonthStart);
        const targetDate = new Date(monthStart.getFullYear(), monthStart.getMonth(), 28 + parseInt(dayOfMonth));
        
        if (targetDate.getMonth() !== monthStart.getMonth() && targetDate.getDate() < 28) {
          targetDate.setMonth(targetDate.getMonth() + 1);
        }
        
        return targetDate;
      };

      const addTransaction = () => {
        if (!transactionForm.description || !transactionForm.amount) {
          alert('Please fill in description and amount');
          return;
        }

        const transactionDate = new Date(transactionForm.date);
        const financeMonth = getFinanceMonthForDate(transactionDate);

        const newTransaction = {
          id: Date.now(),
          ...transactionForm,
          amount: parseFloat(transactionForm.amount),
          financeMonth: financeMonth.toISOString()
        };

        setTransactions([...transactions, newTransaction]);
        setTransactionForm({
          description: '',
          amount: '',
          type: 'expense',
          category: '',
          date: new Date().toISOString().split('T')[0],
          notes: ''
        });
      };

      const deleteTransaction = (id) => {
        if (confirm('Are you sure you want to delete this transaction?')) {
          setTransactions(transactions.filter(t => t.id !== id));
        }
      };

      const addDebt = () => {
        if (!debtForm.name || !debtForm.currentBalance) {
          alert('Please fill in debt name and current balance');
          return;
        }

        const newDebt = {
          id: Date.now(),
          name: debtForm.name,
          originalBalance: parseFloat(debtForm.originalBalance) || parseFloat(debtForm.currentBalance),
          currentBalance: parseFloat(debtForm.currentBalance),
          interestRate: parseFloat(debtForm.interestRate) || 0,
          minimumPayment: parseFloat(debtForm.minimumPayment) || 0,
          dueDay: parseInt(debtForm.dueDay) || 1,
          type: debtForm.type,
          notes: debtForm.notes
        };

        setDebts([...debts, newDebt]);

        // Create recurring payment if requested
        if (debtForm.createRecurringPayment && debtForm.minimumPayment) {
          const newRecurring = {
            id: Date.now() + 1,
            name: `${debtForm.name} - Payment`,
            amount: parseFloat(debtForm.minimumPayment),
            dayOfMonth: parseInt(debtForm.dueDay) || 1,
            category: 'debt',
            autoPay: false,
            linkedDebtId: newDebt.id,
            notes: `Auto-created for ${debtForm.name}`
          };
          setRecurringPayments([...recurringPayments, newRecurring]);
        }

        setDebtForm({
          name: '',
          originalBalance: '',
          currentBalance: '',
          interestRate: '',
          minimumPayment: '',
          dueDay: '',
          type: 'credit_card',
          notes: '',
          createRecurringPayment: false
        });
      };

      const updateDebt = () => {
        if (!editingDebt) return;

        const updatedDebts = debts.map(debt => 
          debt.id === editingDebt.id ? {
            ...editingDebt,
            originalBalance: parseFloat(editingDebt.originalBalance),
            currentBalance: parseFloat(editingDebt.currentBalance),
            interestRate: parseFloat(editingDebt.interestRate) || 0,
            minimumPayment: parseFloat(editingDebt.minimumPayment) || 0,
            dueDay: parseInt(editingDebt.dueDay) || 1
          } : debt
        );

        setDebts(updatedDebts);
        setEditingDebt(null);
      };

      const deleteDebt = (id) => {
        if (confirm('Are you sure you want to delete this debt? This will also remove any linked recurring payments.')) {
          setDebts(debts.filter(d => d.id !== id));
          setRecurringPayments(recurringPayments.filter(p => p.linkedDebtId !== id));
        }
      };

      const addRecurringPayment = () => {
        if (!recurringForm.name || !recurringForm.amount || !recurringForm.dayOfMonth) {
          alert('Please fill in name, amount, and day of month');
          return;
        }

        const newPayment = {
          id: Date.now(),
          ...recurringForm,
          amount: parseFloat(recurringForm.amount),
          dayOfMonth: parseInt(recurringForm.dayOfMonth),
          paidMonths: []
        };

        setRecurringPayments([...recurringPayments, newPayment]);
        setRecurringForm({
          name: '',
          amount: '',
          dayOfMonth: '',
          category: 'utilities',
          autoPay: false,
          linkedDebtId: null,
          notes: ''
        });
      };

      const updateRecurringPayment = () => {
        if (!editingRecurring) return;

        const updatedPayments = recurringPayments.map(payment =>
          payment.id === editingRecurring.id ? {
            ...editingRecurring,
            amount: parseFloat(editingRecurring.amount),
            dayOfMonth: parseInt(editingRecurring.dayOfMonth)
          } : payment
        );

        setRecurringPayments(updatedPayments);
        setEditingRecurring(null);
      };

      const deleteRecurringPayment = (id) => {
        if (confirm('Are you sure you want to delete this recurring payment?')) {
          setRecurringPayments(recurringPayments.filter(p => p.id !== id));
        }
      };

      const toggleRecurringPaid = (paymentId) => {
        const today = new Date();
        const currentFinanceMonth = getFinanceMonthForDate(today);
        const monthKey = currentFinanceMonth.toISOString();

        const updatedPayments = recurringPayments.map(payment => {
          if (payment.id === paymentId) {
            const paidMonths = payment.paidMonths || [];
            const isPaid = paidMonths.includes(monthKey);

            if (isPaid) {
              return {
                ...payment,
                paidMonths: paidMonths.filter(m => m !== monthKey)
              };
            } else {
              return {
                ...payment,
                paidMonths: [...paidMonths, monthKey]
              };
            }
          }
          return payment;
        });

        setRecurringPayments(updatedPayments);
      };

      // Statistics calculations
      const stats = useMemo(() => {
        const currentMonth = getFinanceMonthForDate(new Date());
        const currentMonthKey = currentMonth.toISOString();

        const currentMonthTransactions = transactions.filter(t => 
          t.financeMonth === currentMonthKey
        );

        const totalIncome = currentMonthTransactions
          .filter(t => t.type === 'income')
          .reduce((sum, t) => sum + t.amount, 0);

        const totalExpenses = currentMonthTransactions
          .filter(t => t.type === 'expense')
          .reduce((sum, t) => sum + t.amount, 0);

        const netCashFlow = totalIncome - totalExpenses;

        const totalDebt = debts.reduce((sum, d) => sum + d.currentBalance, 0);

        const monthlyDebtPayments = recurringPayments
          .filter(p => p.category === 'debt' || p.linkedDebtId)
          .reduce((sum, p) => sum + p.amount, 0);

        const totalMonthlyRecurring = recurringPayments
          .reduce((sum, p) => sum + p.amount, 0);

        return {
          totalIncome,
          totalExpenses,
          netCashFlow,
          totalDebt,
          monthlyDebtPayments,
          totalMonthlyRecurring,
          transactionCount: currentMonthTransactions.length
        };
      }, [transactions, debts, recurringPayments]);

      // Filtered transactions
      const filteredTransactions = useMemo(() => {
        return transactions.filter(t => {
          const matchesSearch = t.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               t.notes?.toLowerCase().includes(searchTerm.toLowerCase());
          const matchesType = filterType === 'all' || t.type === filterType;
          const matchesCategory = filterCategory === 'all' || t.category === filterCategory;
          
          return matchesSearch && matchesType && matchesCategory;
        }).sort((a, b) => new Date(b.date) - new Date(a.date));
      }, [transactions, searchTerm, filterType, filterCategory]);

      // Get unique categories
      const categories = [...new Set(transactions.map(t => t.category).filter(Boolean))];

      const toggleSection = (sectionId) => {
        setCollapsedSections(prev => ({
          ...prev,
          [sectionId]: !prev[sectionId]
        }));
      };

      const exportData = () => {
        const data = {
          transactions,
          debts,
          recurringPayments,
          exportDate: new Date().toISOString(),
          version: VERSION
        };

        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `finance-data-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
      };

      const importData = (event) => {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const data = JSON.parse(e.target.result);
            if (confirm('This will replace all current data. Are you sure?')) {
              setTransactions(data.transactions || []);
              setDebts(data.debts || []);
              setRecurringPayments(data.recurringPayments || []);
              alert('Data imported successfully!');
            }
          } catch (error) {
            alert('Error importing data: ' + error.message);
          }
        };
        reader.readAsText(file);
      };

      const clearAllData = () => {
        if (confirm('Are you sure you want to clear ALL data? This cannot be undone!')) {
          if (confirm('Really? This will delete everything!')) {
            setTransactions([]);
            setDebts([]);
            setRecurringPayments([]);
          }
        }
      };

      const formatCurrency = (amount) => {
        return new Intl.NumberFormat('en-US', {
          style: 'currency',
          currency: 'USD'
        }).format(amount);
      };

      const calculateDebtPayoffDate = (debt) => {
        if (debt.currentBalance <= 0) return 'Paid Off';
        if (!debt.minimumPayment || debt.minimumPayment <= 0) return 'N/A';

        const monthlyRate = debt.interestRate / 100 / 12;
        let balance = debt.currentBalance;
        let months = 0;
        const maxMonths = 600; // 50 years max

        while (balance > 0 && months < maxMonths) {
          const interest = balance * monthlyRate;
          const principal = debt.minimumPayment - interest;
          
          if (principal <= 0) return 'Never (payment < interest)';
          
          balance -= principal;
          months++;
        }

        if (months >= maxMonths) return 'Never';

        const payoffDate = new Date();
        payoffDate.setMonth(payoffDate.getMonth() + months);
        
        return payoffDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
      };

      const calculatePayoffMonths = (debt) => {
        if (debt.currentBalance <= 0) return 0;
        if (!debt.minimumPayment || debt.minimumPayment <= 0) return 0;

        const monthlyRate = debt.interestRate / 100 / 12;
        let balance = debt.currentBalance;
        let months = 0;
        const maxMonths = 600;

        while (balance > 0 && months < maxMonths) {
          const interest = balance * monthlyRate;
          const principal = debt.minimumPayment - interest;
          
          if (principal <= 0) return 999;
          
          balance -= principal;
          months++;
        }

        return months >= maxMonths ? 999 : months;
      };

      // Calendar view helpers
      const getCalendarDays = () => {
        const year = calendarMonth.getFullYear();
        const month = calendarMonth.getMonth();
        
        // Get the finance month boundaries (28th to 27th)
        const financeMonthStart = new Date(year, month, 28);
        const financeMonthEnd = new Date(year, month + 1, 27);
        
        const days = [];
        const current = new Date(financeMonthStart);
        
        while (current <= financeMonthEnd) {
          days.push(new Date(current));
          current.setDate(current.getDate() + 1);
        }
        
        return days;
      };

      const getPaymentsForDay = (date) => {
        const currentMonth = getFinanceMonthForDate(calendarMonth);
        const monthKey = currentMonth.toISOString();
        
        return recurringPayments.filter(payment => {
          const paymentDate = getPaymentDateForMonth(payment.dayOfMonth, currentMonth);
          return paymentDate.toDateString() === date.toDateString();
        }).map(payment => ({
          ...payment,
          isPaid: (payment.paidMonths || []).includes(monthKey)
        }));
      };

      const isToday = (date) => {
        const today = new Date();
        return date.toDateString() === today.toDateString();
      };

      const navigateMonth = (direction) => {
        const newMonth = new Date(calendarMonth);
        newMonth.setMonth(newMonth.getMonth() + direction);
        setCalendarMonth(newMonth);
      };

      return (
        <div className="container">
          <div className="header">
            <h1>üí∞ Personal Finance Tracker</h1>
            <div className="version">Version {VERSION}</div>
          </div>

          <div className="tabs">
            <button className={`tab ${activeTab === 'dashboard' ? 'active' : ''}`} onClick={() => setActiveTab('dashboard')}>
              Dashboard
            </button>
            <button className={`tab ${activeTab === 'transactions' ? 'active' : ''}`} onClick={() => setActiveTab('transactions')}>
              Transactions
            </button>
            <button className={`tab ${activeTab === 'debts' ? 'active' : ''}`} onClick={() => setActiveTab('debts')}>
              Debt Tracking
            </button>
            <button className={`tab ${activeTab === 'recurring' ? 'active' : ''}`} onClick={() => setActiveTab('recurring')}>
              Recurring Payments
            </button>
            <button className={`tab ${activeTab === 'calendar' ? 'active' : ''}`} onClick={() => setActiveTab('calendar')}>
              Calendar View
            </button>
          </div>

          {activeTab === 'dashboard' && (
            <div>
              <div className="section">
                <h2>üìä Current Month Overview</h2>
                <div className="stats-grid">
                  <div className="stat-card">
                    <div className="stat-label">Total Income</div>
                    <div className="stat-value positive">{formatCurrency(stats.totalIncome)}</div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-label">Total Expenses</div>
                    <div className="stat-value negative">{formatCurrency(stats.totalExpenses)}</div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-label">Net Cash Flow</div>
                    <div className={`stat-value ${stats.netCashFlow >= 0 ? 'positive' : 'negative'}`}>
                      {formatCurrency(stats.netCashFlow)}
                    </div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-label">Total Debt</div>
                    <div className="stat-value negative">{formatCurrency(stats.totalDebt)}</div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-label">Monthly Debt Payments</div>
                    <div className="stat-value">{formatCurrency(stats.monthlyDebtPayments)}</div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-label">Total Recurring</div>
                    <div className="stat-value">{formatCurrency(stats.totalMonthlyRecurring)}</div>
                  </div>
                </div>
              </div>

              <div className="section">
                <div className="section-header" onClick={() => toggleSection('quick-add')}>
                  <h2>
                    <span className={`toggle-icon ${collapsedSections['quick-add'] ? 'collapsed' : ''}`}>‚ñº</span>
                    ‚ö° Quick Add Transaction
                  </h2>
                </div>
                <div className={`section-content ${collapsedSections['quick-add'] ? 'collapsed' : ''}`}>
                  <div className="form-grid">
                    <div className="form-group">
                      <label>Description</label>
                      <input
                        type="text"
                        value={transactionForm.description}
                        onChange={(e) => setTransactionForm({...transactionForm, description: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Amount</label>
                      <input
                        type="number"
                        step="0.01"
                        value={transactionForm.amount}
                        onChange={(e) => setTransactionForm({...transactionForm, amount: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Type</label>
                      <select
                        value={transactionForm.type}
                        onChange={(e) => setTransactionForm({...transactionForm, type: e.target.value})}
                      >
                        <option value="expense">Expense</option>
                        <option value="income">Income</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label>Category</label>
                      <input
                        type="text"
                        value={transactionForm.category}
                        onChange={(e) => setTransactionForm({...transactionForm, category: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Date</label>
                      <input
                        type="date"
                        value={transactionForm.date}
                        onChange={(e) => setTransactionForm({...transactionForm, date: e.target.value})}
                      />
                    </div>
                  </div>
                  <button onClick={addTransaction}>Add Transaction</button>
                </div>
              </div>

              <div className="section">
                <div className="section-header" onClick={() => toggleSection('recent-transactions')}>
                  <h2>
                    <span className={`toggle-icon ${collapsedSections['recent-transactions'] ? 'collapsed' : ''}`}>‚ñº</span>
                    üìù Recent Transactions
                  </h2>
                </div>
                <div className={`section-content ${collapsedSections['recent-transactions'] ? 'collapsed' : ''}`}>
                  <div className="transaction-list">
                    {transactions.slice(-5).reverse().map(transaction => (
                      <div key={transaction.id} className="transaction-item">
                        <div className="item-header">
                          <span className="item-title">{transaction.description}</span>
                          <span className={`item-amount ${transaction.type}`}>
                            {transaction.type === 'income' ? '+' : '-'}{formatCurrency(transaction.amount)}
                          </span>
                        </div>
                        <div className="item-details">
                          <div className="item-detail">
                            <span className="detail-label">Date</span>
                            <span className="detail-value">{new Date(transaction.date).toLocaleDateString()}</span>
                          </div>
                          <div className="item-detail">
                            <span className="detail-label">Category</span>
                            <span className="detail-value">{transaction.category || 'Uncategorized'}</span>
                          </div>
                        </div>
                      </div>
                    ))}
                    {transactions.length === 0 && (
                      <div className="empty-state">No transactions yet</div>
                    )}
                  </div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'transactions' && (
            <div>
              <div className="section">
                <h2>üîç Search & Filter</h2>
                <input
                  type="text"
                  className="search-bar"
                  placeholder="Search transactions..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                />
                <div className="filter-group">
                  <select value={filterType} onChange={(e) => setFilterType(e.target.value)}>
                    <option value="all">All Types</option>
                    <option value="income">Income</option>
                    <option value="expense">Expense</option>
                  </select>
                  <select value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)}>
                    <option value="all">All Categories</option>
                    {categories.map(cat => (
                      <option key={cat} value={cat}>{cat}</option>
                    ))}
                  </select>
                </div>
              </div>

              <div className="section">
                <h2>üìã All Transactions ({filteredTransactions.length})</h2>
                <div className="transaction-list">
                  {filteredTransactions.map(transaction => (
                    <div key={transaction.id} className="transaction-item">
                      <div className="item-header">
                        <span className="item-title">{transaction.description}</span>
                        <span className={`item-amount ${transaction.type}`}>
                          {transaction.type === 'income' ? '+' : '-'}{formatCurrency(transaction.amount)}
                        </span>
                      </div>
                      <div className="item-details">
                        <div className="item-detail">
                          <span className="detail-label">Date</span>
                          <span className="detail-value">{new Date(transaction.date).toLocaleDateString()}</span>
                        </div>
                        <div className="item-detail">
                          <span className="detail-label">Category</span>
                          <span className="detail-value">{transaction.category || 'Uncategorized'}</span>
                        </div>
                        {transaction.notes && (
                          <div className="item-detail">
                            <span className="detail-label">Notes</span>
                            <span className="detail-value">{transaction.notes}</span>
                          </div>
                        )}
                        {transaction.autoPaid && (
                          <div className="item-detail">
                            <span className="detail-label">Auto-Paid</span>
                            <span className="detail-value">‚úì Yes</span>
                          </div>
                        )}
                      </div>
                      <div className="button-group" style={{marginTop: '10px'}}>
                        <button className="delete" onClick={() => deleteTransaction(transaction.id)}>Delete</button>
                      </div>
                    </div>
                  ))}
                  {filteredTransactions.length === 0 && (
                    <div className="empty-state">No transactions found</div>
                  )}
                </div>
              </div>
            </div>
          )}

          {activeTab === 'debts' && (
            <div>
              <div className="section">
                <div className="section-header" onClick={() => toggleSection('add-debt')}>
                  <h2>
                    <span className={`toggle-icon ${collapsedSections['add-debt'] ? 'collapsed' : ''}`}>‚ñº</span>
                    ‚ûï Add New Debt
                  </h2>
                </div>
                <div className={`section-content ${collapsedSections['add-debt'] ? 'collapsed' : ''}`}>
                  <div className="form-grid">
                    <div className="form-group">
                      <label>Debt Name</label>
                      <input
                        type="text"
                        value={debtForm.name}
                        onChange={(e) => setDebtForm({...debtForm, name: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Current Balance</label>
                      <input
                        type="number"
                        step="0.01"
                        value={debtForm.currentBalance}
                        onChange={(e) => setDebtForm({...debtForm, currentBalance: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Original Balance (optional)</label>
                      <input
                        type="number"
                        step="0.01"
                        value={debtForm.originalBalance}
                        onChange={(e) => setDebtForm({...debtForm, originalBalance: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Interest Rate (%)</label>
                      <input
                        type="number"
                        step="0.01"
                        value={debtForm.interestRate}
                        onChange={(e) => setDebtForm({...debtForm, interestRate: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Minimum Payment</label>
                      <input
                        type="number"
                        step="0.01"
                        value={debtForm.minimumPayment}
                        onChange={(e) => setDebtForm({...debtForm, minimumPayment: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Due Day of Month (1-30)</label>
                      <input
                        type="number"
                        min="1"
                        max="30"
                        value={debtForm.dueDay}
                        onChange={(e) => setDebtForm({...debtForm, dueDay: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Type</label>
                      <select
                        value={debtForm.type}
                        onChange={(e) => setDebtForm({...debtForm, type: e.target.value})}
                      >
                        <option value="credit_card">Credit Card</option>
                        <option value="loan">Loan</option>
                        <option value="mortgage">Mortgage</option>
                        <option value="other">Other</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label>Notes</label>
                      <input
                        type="text"
                        value={debtForm.notes}
                        onChange={(e) => setDebtForm({...debtForm, notes: e.target.value})}
                      />
                    </div>
                  </div>
                  <div className="checkbox-group" style={{marginTop: '15px', marginBottom: '15px'}}>
                    <input
                      type="checkbox"
                      id="createRecurring"
                      checked={debtForm.createRecurringPayment}
                      onChange={(e) => setDebtForm({...debtForm, createRecurringPayment: e.target.checked})}
                    />
                    <label htmlFor="createRecurring">Create recurring payment for minimum payment</label>
                  </div>
                  <button onClick={addDebt}>Add Debt</button>
                </div>
              </div>

              <div className="section">
                <h2>üí≥ Active Debts</h2>
                <div className="debt-list">
                  {debts.map(debt => (
                    <div key={debt.id} className="debt-item">
                      {editingDebt && editingDebt.id === debt.id ? (
                        <div>
                          <div className="form-grid">
                            <div className="form-group">
                              <label>Debt Name</label>
                              <input
                                type="text"
                                value={editingDebt.name}
                                onChange={(e) => setEditingDebt({...editingDebt, name: e.target.value})}
                              />
                            </div>
                            <div className="form-group">
                              <label>Current Balance</label>
                              <input
                                type="number"
                                step="0.01"
                                value={editingDebt.currentBalance}
                                onChange={(e) => setEditingDebt({...editingDebt, currentBalance: e.target.value})}
                              />
                            </div>
                            <div className="form-group">
                              <label>Original Balance</label>
                              <input
                                type="number"
                                step="0.01"
                                value={editingDebt.originalBalance}
                                onChange={(e) => setEditingDebt({...editingDebt, originalBalance: e.target.value})}
                              />
                            </div>
                            <div className="form-group">
                              <label>Interest Rate (%)</label>
                              <input
                                type="number"
                                step="0.01"
                                value={editingDebt.interestRate}
                                onChange={(e) => setEditingDebt({...editingDebt, interestRate: e.target.value})}
                              />
                            </div>
                            <div className="form-group">
                              <label>Minimum Payment</label>
                              <input
                                type="number"
                                step="0.01"
                                value={editingDebt.minimumPayment}
                                onChange={(e) => setEditingDebt({...editingDebt, minimumPayment: e.target.value})}
                              />
                            </div>
                            <div className="form-group">
                              <label>Due Day</label>
                              <input
                                type="number"
                                min="1"
                                max="30"
                                value={editingDebt.dueDay}
                                onChange={(e) => setEditingDebt({...editingDebt, dueDay: e.target.value})}
                              />
                            </div>
                          </div>
                          <div className="button-group" style={{marginTop: '15px'}}>
                            <button onClick={updateDebt}>Save Changes</button>
                            <button className="secondary" onClick={() => setEditingDebt(null)}>Cancel</button>
                          </div>
                        </div>
                      ) : (
                        <div>
                          <div className="item-header">
                            <span className="item-title">{debt.name}</span>
                            <span className="item-amount expense">{formatCurrency(debt.currentBalance)}</span>
                          </div>
                          <div style={{fontSize: '0.9rem', color: '#94a3b8', marginTop: '5px'}}>
                            {debt.type.replace('_', ' ').toUpperCase()} ‚Ä¢ Balance: {formatCurrency(debt.currentBalance)}
                          </div>
                          <div className="item-details">
                            <div className="item-detail">
                              <span className="detail-label">Original Balance</span>
                              <span className="detail-value">{formatCurrency(debt.originalBalance)}</span>
                            </div>
                            <div className="item-detail">
                              <span className="detail-label">Current Balance</span>
                              <span className="detail-value">{formatCurrency(debt.currentBalance)}</span>
                            </div>
                            <div className="item-detail">
                              <span className="detail-label">Interest Rate</span>
                              <span className="detail-value">{debt.interestRate}%</span>
                            </div>
                            <div className="item-detail">
                              <span className="detail-label">Minimum Payment</span>
                              <span className="detail-value">{formatCurrency(debt.minimumPayment)}</span>
                            </div>
                            <div className="item-detail">
                              <span className="detail-label">Payoff Timeline</span>
                              <span className="detail-value">{calculatePayoffMonths(debt)} months</span>
                            </div>
                            <div className="item-detail">
                              <span className="detail-label">Projected Payoff</span>
                              <span className="detail-value">{calculateDebtPayoffDate(debt)}</span>
                            </div>
                          </div>
                          <div style={{marginTop: '10px'}}>
                            <div style={{fontSize: '0.85rem', color: '#94a3b8', marginBottom: '5px'}}>
                              Progress: {((1 - debt.currentBalance / debt.originalBalance) * 100).toFixed(1)}% paid off
                            </div>
                            <div className="progress-bar">
                              <div 
                                className="progress-fill" 
                                style={{width: `${Math.min(100, (1 - debt.currentBalance / debt.originalBalance) * 100)}%`}}
                              ></div>
                            </div>
                          </div>
                          <div className="button-group" style={{marginTop: '15px'}}>
                            <button onClick={() => setEditingDebt(debt)}>Edit Debt</button>
                            <button className="delete" onClick={() => deleteDebt(debt.id)}>Delete Debt</button>
                          </div>
                        </div>
                      )}
                    </div>
                  ))}
                  {debts.length === 0 && (
                    <div className="empty-state">No debts tracked yet</div>
                  )}
                </div>
              </div>
            </div>
          )}

          {activeTab === 'recurring' && (
            <div>
              <div className="section">
                <div className="section-header" onClick={() => toggleSection('add-recurring')}>
                  <h2>
                    <span className={`toggle-icon ${collapsedSections['add-recurring'] ? 'collapsed' : ''}`}>‚ñº</span>
                    ‚ûï Add Recurring Payment
                  </h2>
                </div>
                <div className={`section-content ${collapsedSections['add-recurring'] ? 'collapsed' : ''}`}>
                  <div className="form-grid">
                    <div className="form-group">
                      <label>Payment Name</label>
                      <input
                        type="text"
                        value={recurringForm.name}
                        onChange={(e) => setRecurringForm({...recurringForm, name: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Amount</label>
                      <input
                        type="number"
                        step="0.01"
                        value={recurringForm.amount}
                        onChange={(e) => setRecurringForm({...recurringForm, amount: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Day of Month (1-30)</label>
                      <input
                        type="number"
                        min="1"
                        max="30"
                        value={recurringForm.dayOfMonth}
                        onChange={(e) => setRecurringForm({...recurringForm, dayOfMonth: e.target.value})}
                      />
                    </div>
                    <div className="form-group">
                      <label>Category</label>
                      <select
                        value={recurringForm.category}
                        onChange={(e) => setRecurringForm({...recurringForm, category: e.target.value})}
                      >
                        <option value="utilities">Utilities</option>
                        <option value="subscriptions">Subscriptions</option>
                        <option value="insurance">Insurance</option>
                        <option value="debt">Debt Payment</option>
                        <option value="other">Other</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label>Link to Debt (optional)</label>
                      <select
                        value={recurringForm.linkedDebtId || ''}
                        onChange={(e) => setRecurringForm({...recurringForm, linkedDebtId: e.target.value || null})}
                      >
                        <option value="">None</option>
                        {debts.map(debt => (
                          <option key={debt.id} value={debt.id}>{debt.name}</option>
                        ))}
                      </select>
                    </div>
                    <div className="form-group">
                      <label>Notes</label>
                      <input
                        type="text"
                        value={recurringForm.notes}
                        onChange={(e) => setRecurringForm({...recurringForm, notes: e.target.value})}
                      />
                    </div>
                  </div>
                  <div className="checkbox-group" style={{marginTop: '15px', marginBottom: '15px'}}>
                    <input
                      type="checkbox"
                      id="autoPay"
                      checked={recurringForm.autoPay}
                      onChange={(e) => setRecurringForm({...recurringForm, autoPay: e.target.checked})}
                    />
                    <label htmlFor="autoPay">Enable Auto-Pay (automatically create transactions)</label>
                  </div>
                  <button onClick={addRecurringPayment}>Add Recurring Payment</button>
                </div>
              </div>

              <div className="section">
                <h2>üîÑ Recurring Payments</h2>
                <div className="recurring-list">
                  {recurringPayments.map(payment => {
                    const currentMonth = getFinanceMonthForDate(new Date());
                    const monthKey = currentMonth.toISOString();
                    const isPaid = (payment.paidMonths || []).includes(monthKey);
                    const linkedDebt = payment.linkedDebtId ? debts.find(d => d.id === payment.linkedDebtId) : null;

                    return (
                      <div key={payment.id} className="recurring-item">
                        {editingRecurring && editingRecurring.id === payment.id ? (
                          <div>
                            <div className="form-grid">
                              <div className="form-group">
                                <label>Payment Name</label>
                                <input
                                  type="text"
                                  value={editingRecurring.name}
                                  onChange={(e) => setEditingRecurring({...editingRecurring, name: e.target.value})}
                                />
                              </div>
                              <div className="form-group">
                                <label>Amount</label>
                                <input
                                  type="number"
                                  step="0.01"
                                  value={editingRecurring.amount}
                                  onChange={(e) => setEditingRecurring({...editingRecurring, amount: e.target.value})}
                                />
                              </div>
                              <div className="form-group">
                                <label>Day of Month</label>
                                <input
                                  type="number"
                                  min="1"
                                  max="30"
                                  value={editingRecurring.dayOfMonth}
                                  onChange={(e) => setEditingRecurring({...editingRecurring, dayOfMonth: e.target.value})}
                                />
                              </div>
                              <div className="form-group">
                                <label>Category</label>
                                <select
                                  value={editingRecurring.category}
                                  onChange={(e) => setEditingRecurring({...editingRecurring, category: e.target.value})}
                                >
                                  <option value="utilities">Utilities</option>
                                  <option value="subscriptions">Subscriptions</option>
                                  <option value="insurance">Insurance</option>
                                  <option value="debt">Debt Payment</option>
                                  <option value="other">Other</option>
                                </select>
                              </div>
                              <div className="form-group">
                                <label>Link to Debt</label>
                                <select
                                  value={editingRecurring.linkedDebtId || ''}
                                  onChange={(e) => setEditingRecurring({...editingRecurring, linkedDebtId: e.target.value || null})}
                                >
                                  <option value="">None</option>
                                  {debts.map(debt => (
                                    <option key={debt.id} value={debt.id}>{debt.name}</option>
                                  ))}
                                </select>
                              </div>
                            </div>
                            <div className="checkbox-group" style={{marginTop: '15px'}}>
                              <input
                                type="checkbox"
                                id={`editAutoPay-${payment.id}`}
                                checked={editingRecurring.autoPay}
                                onChange={(e) => setEditingRecurring({...editingRecurring, autoPay: e.target.checked})}
                              />
                              <label htmlFor={`editAutoPay-${payment.id}`}>Enable Auto-Pay</label>
                            </div>
                            <div className="button-group" style={{marginTop: '15px'}}>
                              <button onClick={updateRecurringPayment}>Save Changes</button>
                              <button className="secondary" onClick={() => setEditingRecurring(null)}>Cancel</button>
                            </div>
                          </div>
                        ) : (
                          <div>
                            <div className="item-header">
                              <span className="item-title">
                                {payment.name}
                                {payment.autoPay && <span style={{marginLeft: '10px', fontSize: '0.85rem', color: '#a855f7'}}>ü§ñ AUTO-PAY</span>}
                                {isPaid && <span style={{marginLeft: '10px', fontSize: '0.85rem', color: '#34d399'}}>‚úì PAID</span>}
                              </span>
                              <span className="item-amount expense">{formatCurrency(payment.amount)}</span>
                            </div>
                            <div className="item-details">
                              <div className="item-detail">
                                <span className="detail-label">Due Day</span>
                                <span className="detail-value">Day {payment.dayOfMonth} of month</span>
                              </div>
                              <div className="item-detail">
                                <span className="detail-label">Category</span>
                                <span className="detail-value">{payment.category}</span>
                              </div>
                              {linkedDebt && (
                                <div className="item-detail">
                                  <span className="detail-label">Linked Debt</span>
                                  <span className="detail-value">{linkedDebt.name}</span>
                                </div>
                              )}
                              {payment.notes && (
                                <div className="item-detail">
                                  <span className="detail-label">Notes</span>
                                  <span className="detail-value">{payment.notes}</span>
                                </div>
                              )}
                            </div>
                            <div className="button-group" style={{marginTop: '15px'}}>
                              {!payment.autoPay && (
                                <button 
                                  className={isPaid ? 'secondary' : ''}
                                  onClick={() => toggleRecurringPaid(payment.id)}
                                >
                                  {isPaid ? 'Mark Unpaid' : 'Mark Paid'}
                                </button>
                              )}
                              <button onClick={() => setEditingRecurring(payment)}>Edit</button>
                              <button className="delete" onClick={() => deleteRecurringPayment(payment.id)}>Delete</button>
                            </div>
                          </div>
                        )}
                      </div>
                    );
                  })}
                  {recurringPayments.length === 0 && (
                    <div className="empty-state">No recurring payments set up yet</div>
                  )}
                </div>
              </div>
            </div>
          )}

          {activeTab === 'calendar' && (
            <div>
              <div className="section">
                <h2>üìÖ Payment Calendar</h2>
                <div className="month-selector">
                  <button onClick={() => navigateMonth(-1)}>‚Üê Previous Month</button>
                  <div className="month-display">
                    {calendarMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                    <div style={{fontSize: '0.8rem', color: '#94a3b8', marginTop: '5px'}}>
                      Finance Month: 28th - 27th
                    </div>
                  </div>
                  <button onClick={() => navigateMonth(1)}>Next Month ‚Üí</button>
                </div>
                <div className="calendar-view">
                  {getCalendarDays().map((day, index) => {
                    const payments = getPaymentsForDay(day);
                    return (
                      <div 
                        key={index} 
                        className={`calendar-day ${isToday(day) ? 'today' : ''}`}
                      >
                        <div className="calendar-day-header">
                          {day.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                        </div>
                        {payments.map(payment => (
                          <div 
                            key={payment.id} 
                            className={`calendar-payment ${payment.isPaid ? 'paid' : ''} ${payment.autoPay ? 'auto' : ''}`}
                          >
                            <div style={{fontWeight: 'bold'}}>{payment.name}</div>
                            <div>{formatCurrency(payment.amount)}</div>
                            {payment.autoPay && <div style={{fontSize: '0.7rem'}}>ü§ñ Auto</div>}
                            {payment.isPaid && <div style={{fontSize: '0.7rem'}}>‚úì Paid</div>}
                          </div>
                        ))}
                      </div>
                    );
                  })}
                </div>
              </div>
            </div>
          )}

          <div className="section">
            <h2>üíæ Data Management</h2>
            <div className="data-management">
              <button onClick={exportData}>Export Data</button>
              <button className="secondary" onClick={() => document.getElementById('import-file').click()}>
                Import Data
              </button>
              <input
                id="import-file"
                type="file"
                accept=".json"
                style={{display: 'none'}}
                onChange={importData}
              />
              <button className="delete" onClick={clearAllData}>Clear All Data</button>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<FinanceTracker />, document.getElementById('root'));
  </script>
</body>
</html>
